--DROP SCHEMA T4H CASCADE;
CREATE SCHEMA T4H;
SET SCHEMA T4H;
/*
DROP TABLE EMP;
DROP TABLE DEPT;
DROP TABLE EMP_BONUS;
DROP TABLE MATRIX1;
DROP TABLE MATRIX10;
DROP TABLE PRODUCT;
DROP TABLE REGION;
DROP TABLE SALES;
DROP PROCEDURE "GENERATE_SALES_DATA";
*/

CREATE COLUMN TABLE EMP
(
		EMPNO INT NOT NULL,
        ENAME VARCHAR(10),
		DOB DATE,
        JOB VARCHAR(9),
        MGR INT,
        HIREDATE DATE,
        SAL INT,
        COMM INT,
        DEPTNO INT
);

INSERT INTO EMP VALUES(369, 'Mr. A', '19800821', 'CLERK',     902, '19801217',  800, NULL, 20);
INSERT INTO EMP VALUES(499, 'Ms. Q', '19811201', 'SALESMAN',  698, '19810220', 1600,  300, 30);
INSERT INTO EMP VALUES(521, 'Mr. C', '19750518', 'SALESMAN',  698, '19810222', 1250,  500, 30);
INSERT INTO EMP VALUES(566, 'Ms. R', '19830209', 'MANAGER',   839, '19810402', 2975, NULL, 20);
INSERT INTO EMP VALUES(654, 'Mr. E', '19600606', 'SALESMAN',  698, '19810928', 1250, 1400, 30);
INSERT INTO EMP VALUES(698, 'Mr. F', '20010929', 'MANAGER',   839, '19810501', 2850, NULL, 30);
INSERT INTO EMP VALUES(782, 'Mr. Y', '20030417', 'MANAGER',   839, '19810609', 2450, NULL, 10);
INSERT INTO EMP VALUES(788, 'Mr. H', '19660219', 'ANALYST',   566, '19821209', 3000, NULL, 20);
INSERT INTO EMP VALUES(839, 'Mr. K', '19501012', 'PRESIDENT', NULL,'19811117', 5000, NULL, 10);
INSERT INTO EMP VALUES(844, 'Ms. L', '19880824', 'SALESMAN',  698, '19810908', 1500,    0, 30);
INSERT INTO EMP VALUES(876, 'Ms. P', '19950712', 'CLERK',     788, '19830112', 1100, NULL, 20);
INSERT INTO EMP VALUES(900, 'Mr. x', '19901101', 'CLERK',     698, '19811203',  950, NULL, 30);
INSERT INTO EMP VALUES(902, 'Mr. F', '19991002', 'ANALYST',   566, '19811203', 3000, NULL, 20);
INSERT INTO EMP VALUES(934, 'Mr. M', '19700821', 'CLERK',     782, '19820123', 1300, NULL, 10);

CREATE TABLE DEPT
(
	    DEPTNO INT,
        DNAME VARCHAR(14),
        LOC VARCHAR(13) 
);

INSERT INTO DEPT VALUES (10, 'ACCOUNTING', 'DELHI');
INSERT INTO DEPT VALUES (20, 'RESEARCH',   'LONDON');
INSERT INTO DEPT VALUES (30, 'SALES',      'CHICAGO');
INSERT INTO DEPT VALUES (40, 'OPERATIONS', 'BERLIN');

CREATE COLUMN TABLE EMP_BONUS
(
	EMPNO		INT,
	RECEIVED	DATE,
	BONUS_TYPE		INT
);
INSERT INTO EMP_BONUS VALUES(934, '20150317', 1);
INSERT INTO EMP_BONUS VALUES(934, '20150215', 2);
INSERT INTO EMP_BONUS VALUES(839, '20150215', 3);
INSERT INTO EMP_BONUS VALUES(782, '20150215', 1);

CREATE COLUMN TABLE MATRIX1 (ID INT);
INSERT INTO MATRIX1 VALUES (1);

CREATE COLUMN TABLE MATRIX10 (ID INT);

INSERT INTO MATRIX10 VALUES (1);
INSERT INTO MATRIX10 VALUES (2);
INSERT INTO MATRIX10 VALUES (3);
INSERT INTO MATRIX10 VALUES (4);
INSERT INTO MATRIX10 VALUES (5);
INSERT INTO MATRIX10 VALUES (6);
INSERT INTO MATRIX10 VALUES (7);
INSERT INTO MATRIX10 VALUES (8);
INSERT INTO MATRIX10 VALUES (9);
INSERT INTO MATRIX10 VALUES (10);

SELECT * FROM MATRIX1;
SELECT * FROM MATRIX10;

-- Create Product table
create column table PRODUCT
( 
    PRODUCT_ID INTEGER, 
    PRODUCT_NAME VARCHAR (100),
    primary key (PRODUCT_ID)
);
insert into PRODUCT values(1,'MicroSD card');
insert into PRODUCT values(2,'Bluetooth speaker');
insert into PRODUCT values(3,'Smart TV');
insert into PRODUCT values(4,'Laptop');
insert into PRODUCT values(5,'Mobile');
insert into PRODUCT values(6,'Projector');
insert into PRODUCT values(7,'Mini PC');
insert into PRODUCT values(8,'Fitness tracker');
insert into PRODUCT values(9,'Camera');

--Create Region table
create column table REGION
(
	REGION_ID INTEGER, 
	REGION_NAME VARCHAR (20),
	DIVISION VARCHAR (30),
	PRIMARY KEY (REGION_ID) 
);
insert into REGION values(1,'Americas','North-America');
insert into REGION values(2,'Americas','South-America');
insert into REGION values(3,'Asia','India');
insert into REGION values(4,'Asia','Japan');
insert into REGION values(5,'Asia','Chaina');
insert into REGION values(6,'Europe','Germany');
insert into REGION values(7,'Europe','UK');
insert into REGION values(8,'Africa','Egypt');
insert into REGION values(9,'Australia','Sidney');

--Create Sales table
create column table SALES
(
	SO_ID INT,
    TRX_DATE DATE,
    REGION_ID INTEGER ,
    PRODUCT_ID INTEGER ,
    SALES_AMOUNT DOUBLE,
    PRIMARY KEY (SO_ID) 
);

CREATE PROCEDURE GENERATE_SALES_DATA (IN RECS INT) 
LANGUAGE SQLSCRIPT AS
CNTR INT := 0;
BEGIN
	IF NOT IS_EMPTY(SALES) THEN
	DELETE FROM SALES;
	END IF;
	WHILE CNTR < :RECS DO
	INSERT INTO SALES 
	  SELECT :CNTR+1000, 
		ADD_DAYS (TO_DATE ('2017-01-01', 'YYYY-MM-DD'), RAND() * 730),
		SUBSTR (ROUND((RAND()*9)+1,0),1,1),
		SUBSTR (ROUND((RAND()*9)+1,0),1,1),
		ROUND(RAND()*1000,0)
	  FROM DUMMY; 
	 CNTR := CNTR+1;
	END WHILE;
END;


CALL "GENERATE_SALES_DATA"(100000);
SELECT COUNT(*) FROM SALES;
SELECT REGION_ID, COUNT(*) FROM SALES GROUP BY REGION_ID;

SELECT * FROM EMP;
SELECT * FROM DEPT;
SELECT * FROM EMP_BONUS;
SELECT * FROM MATRIX1;
SELECT * FROM MATRIX10;
SELECT * FROM PRODUCT;
SELECT * FROM REGION;
SELECT * FROM SALES;
